<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title>Sprint2</title>
        <link rel="stylesheet" type="text/css" href="../../../commons/resources/styles/templateISS.css">
        <link rel="stylesheet" type="text/css" href="../../../commons/resources/styles/main.css">
        <link rel="stylesheet" type="text/css" href="../../../commons/resources/styles/navbar.css">
        <link rel="stylesheet" type="text/css" href="../../../commons/resources/styles/table.css">
        <link rel="stylesheet" type="text/css" href="../../../commons/resources/styles/code.css">
        <script type="text/javascript" src="../../../commons/resources/scripts/myScripts.js"></script>
    </head>

    <body onload="loadNav();">
        <div id="openButton" class="openButton" onclick="openNav(true)">&#9776; Menu</div>
        <div id="sidenav" class="sidenav">
            <a class="closeButton" href="javascript:void(0)" onclick="closeNav(true)">&times;</a>
            <a class="sprint" href="../../../Sprint0/index.html">Sprint0</a>
            <a class="sprint" href="../../../Sprint1/index.html">Sprint1</a>
            <a id="currentSprint" class="sprint" href="#">&#8211;&#8212; Sprint2 &#8212;&#8211;</a>
            <a href="../../index.html">Index</a>
            <a href="final_theme.html">Final Theme</a>
            <a href="requirement_analysis.html">Requirement<br/>Analysis</a>
            <a href="problem_analysis.html">Problem Analysis</a>
            <a class="selected" href="project.html">Project</a>
            <div class="sidenavSection">
                <a href="#Defects-Solution">Defects-Solution</a>
                <a href="#Logical-Architecture">Logical Architecture</a>
                <a href="#Software-Name">&lt;Software Name&gt;</a>
                <div class="sidenavSubSection">
                </div>
                <a href="#Deployment">Deployment</a>
                <a href="#Raspberry-Demo">Raspberry Demo</a>
            </div>
            <a href="test_plans.html">Test Plans</a>
            <a href="conclusions.html">Conclusions</a>
            <a href="team.html">Team</a>
            <p class="separator">&mdash;&mdash;&mdash;&ndash;&ndash;&mdash;&mdash;&mdash;</p>
            <a class="sprint" href="../../../Sprint3/index.html">Sprint3</a>
            <bottom-spacer/>
        </div>

        <div id="main">
            <h1 align="center">Project</h1>
            The project contains all the software our team developed to achieve the Sprint2 SCRUM goal.

            <h2 id="Defects-Solution">Defects Solution</h2>
            <h3>SmartDevice</h3>
            We upgraded the <ksi>SmartDevice</ksi> application to include a Menu and a <kc>Settings page</kc>.
            This page allows the user to change the <i>message parameter</i>:
            <ul>
                <li>message <b>ID</b>;</li>
                <li>message <b>type</b>;</li>
                <li><b>sender</b> actor name;</li>
                <li><b>receiver</b> actor name.</li>
            </ul>
            If the parameters are different from the ones for the WasteService <ks><code>storerequest</code></ks>,
            the view for the sending interface is simple. 
            <h4>Views</h4>
            <img width="200px" src="../imgs/project/SmartDeviceSimulator_Settings.png">
            <img width="200px" src="../imgs/project/SmartDeviceSimulator_SendMessageInterface.png">

            <h3>MapEditor</h3>
            We upgraded the <ksi>MapEditor</ksi> application to fix/implement the following <kc>features</kc>:
            <ul>
                <li><code>roomMap</code> and <code>mapConfig</code> objects loading from file
                    and saving to file with path tracking from settings;</li>
                <li>File errors handling;</li>
                <li>Persistent settings;</li>
                <li>Logger (to console and to file).</li>
            </ul>

            <h2 id="Logical-Architecture">Logical Architecture</h2>
            The main change in the logical architecture from the Problem Analysis is [...].
            <br/>
            <img width="100%" src="../../Sprint1_Project/sprint1_waste_service/project_logical_architecture_core-business.png"/>
            QAK model: <a href="../../Sprint1_Project/sprint1_waste_service/src/project_logical_architecture.qak">project_logical_architecture.qak</a>

            <h2 id="WasteService">Sprint2.1: WasteService</h2>
            <ksi>&lt;Raspberry-Pi-Software-Name&gt;</ksi> (<a href="../../Sprint2_Project/project_directory/">project_directory</a>) is a [...]
            
            <h4>Actor PathExecutorBCR</h4>
            We modified the pathexecutor QAK actor to include the stop/resume functionality:
            <ul>
                <li>Actor renamed to "pathexecutorbcr"</li>
                <li>General refactor: renamed states, and added some middle ones (e.g. state_idle)</li>
                <li>Added a guard checking for stop events (<code>Transition t1 whenEvent stop -> state_stop</code>) at the end of the following states:
                    <ul>
                        <li>state_idle (the state where the actor waits for path requests);</li>
                        <li>state_do_move_forward;</li>
                        <li>state_do_move_turn.</li>
                    </ul>
                </li>
                <li>
                    Added the state "state_stop"
<pre style="white-space: pre;">
State state_stop {
    [# var PathTodo = pathut.getPathTodo() #]
    println("[PathExecutorBCR] Alarm detected, trolley stopped. Path to do: $PathTodo")
}
Transition t3 whenEvent resume -> state_resume
</pre>
                </li>
                <li>
                    Added the state "state_resume"
<pre style="white-space: pre;">
State state_resume {
    println("[PathExecutorBCR] Alarm retracted. Resuming...")
}
Goto state_next_move if [# MovesDone.length != TotPathMoves #] else state_idle
</pre>
                </li>
            </ul>

            <br/>

            <h4>Class TransportTrolleyState</h4>
            classe per rappresentare stato trolley
            <h4>Class LedState</h4>
            classe per rappresentare stato led
            <h4>Utility Functions</h4>
            
            funzione isAlarm()
            <br/>
            funzione getLedStateFromTrolleyState()

            
            <h2>Sprint 2.2: Raspberry Pi Software</h2>
            <h3 id="Device">Device</h3>
            The device used is a <a href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/">Raspberry Pi 4 Model B</a>: <highlight1>Specifiche</highlight1>
            <br/>
            <highlight1>Schema pin</highlight1>
            <br/>
            <highlight1>Setup SSH without password</highlight1>
            <h3>Sonar</h3>
            Per implementare la feature del sonar, abbiamo preso un progetto fornito dalla nostra
            software house (sonarqak) e ne abbiamo ricavato una versione specializzata:
            abbiamo creato degli script python per diverse funzionalità

            <ol>
                <li>SonarAloneBCR.c</li>
                <li>buzzerBCR.py</li>
                <li>displayBCR.py</li>
                <li>sonarBCR.py</li>
                <li>ledBCR.py</li>
            </ol>

            Inizialmente abbiamo creato un programma C chiamato SonarWrapperBCR.c che utilizzasse
            gli script python. Tuttavia, la chiamata di programmi esterni generava overhead e ne rallentava
            l'esecuzione. Quindi abbiamo deciso di creare un programma completamente in C che implementasse
            tutte le funzioni, ed implementare la possibilità di abilitare le varie feature tramite opzioni passate
            come argomenti del programma.

            <h3>Led</h3>
            <h2 id="Extras">Sprint 2 Extras: Radar GUI</h2>
            Since our software house already developed a project capable of showing sonar
            information in a fancy way, we considered its usage and analyzed if there was
            a way to adapt it and include it in our Waste Service project.
            <br/><br/>

            The <ksi>Radar GUI</ksi> project consists of an application able to display
            elaborated information of detected obstacles, with a sonar-like graphical
            interface:
            a line the length of the radius constantly rotates with its pivot in the
            center of the screen, <b><i>simulating a sonar</i></b>. Detected obstacles (with their
            distance and angle) are stored in a queue and, if the detected obstacle 
            distance is within the bounds of interest, as soon as the line encounters
            the point, the application display

            <center>
                <img width="50%" src="../imgs/radarGUI.gif"/>
            </center>

            The Radar GUI project is completely written in C with SDL2 and 
            includes an interface to ease the networking communication, using UDP and 
            TCP.
            <br/><br/>

            Example usage: run the radarGUI on a computer, and a client on a Raspberry Pi,
            which detects obstacles with the sonar module, and sends the data by using the
            networking interface.
            
            <problem>Problemi: PIN del raspberry</problem>
            <highlight1>Spiegare dettagliatamente perché abbiamo scartato l'idea di mettere
                radarGUI sul raspberry
            </highlight1>

            
            <h2 id="Deployment">Deployment</h2>
            Until now we deployed our sistem using the Gradle JAR plugin.
            
            However, a better approach would be to use the distribution plugin:
            https://docs.gradle.org/current/userguide/distribution_plugin.html

            which allows


            <h2 id="Raspberry-Demo">Raspberry Demo</h2>
            In order to run demo components we need:
            [...]
            
            <h4>Setup Remote Communications</h4>
            <highlight1>To setup remote communication refer to this: link.</highlight1>
        
        </div>

    </body>

</html>
