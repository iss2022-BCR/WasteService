<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <title>Sprint0</title>
        <link rel="stylesheet" type="text/css" href="../styles/templateISS.css">
        <link rel="stylesheet" type="text/css" href="../styles/main.css">
        <link rel="stylesheet" type="text/css" href="../styles/navbar.css">
        <link rel="stylesheet" type="text/css" href="../styles/table.css">
        <link rel="stylesheet" type="text/css" href="../styles/code.css">
        <script type="text/javascript" src="../scripts/myScripts.js"></script>
    </head>

    <body onload="loadNav();">
        <div id="openButton" class="openButton" onclick="openNav(true)">&#9776; Menu</div>
        <div id="sidenav" class="sidenav">
            <a class="closeButton" href="javascript:void(0)" onclick="closeNav(true)">&times;</a>
            <a href="../../index.html">Index</a>
            <a href="final_theme.html">Final Theme</a>
            <a href="requirement_analysis.html">Requirement<br/>Analysis</a>
            <a class="selected" href="problem_analysis.html">Problem Analysis</a>
            <div class="sidenavSection">
                <a href="#Requirements-Formalization">Requirements<br/>Formalization</a>
                <div class="sidenavSubSection">
                    <a href="#Entities">Entities</a>
                    <a href="#Data">Data</a>
                    <a href="#Messages">Messages</a>
                </div>
                <a href="#Models">Models</a>
                <div class="sidenavSubSection">
                    <a href="#System-QAK-Model">System QAK Model</a>
                </div>
                <a href="#Logical-Architecture">Logical Architecture</a>
                <a href="#Test-Plans">Test Plans</a>
            </div>
            <a href="conclusions.html">Conclusions</a>
            <a href="team.html">Team</a>
            <p style="height: 100px; visibility: hidden"></p><!-- tmp -->
        </div>

        <div id="main">
            <h1 align="center">Problem Analysis</h1>
            <!--<h2 id="Service-Area">Service Area</h2>
            <highlight2>Forse questa Ã¨ meglio metterla in uno Sprint# a parte, e per ora descrivere le posizioni a parole</highlight2>
            <b>Problem</b>: we need a proper <i>representation</i> of the service area to optimally move and monitor the transport trolley.<br/>
            <b>Solution</b>: <ksi>2x2 matrix</ksi>, where each element represents a different position, starting from the top-left corner.<br/>
            <b>Reasons</b>:
            <ul>
                <li>
                    Since the HOME is the top-left corner, it's more intuitive to represent it as the
                    first element of the matrix, which is the [0,0] element. 
                </li>
                <li>
                    We can associate a <b>cartesian coordinate system</b> to the matrix with the origin in the
                    top-left corner and RD as unit. That might make things easier later on, if we will
                    need to implement a graphical representation of the transport trolley state 
                    (for example in WasteServiceStatusGUI).
                    This because almost every software, library, framework or API, start drawing from
                    the top-left corner to the bottom-right one.
                </li>
            </ul>

            <div class="image-container">
                <img id="map" class="base-image" width="100%" src="../../resources/imgs/modello_stanza_v4.png"/>
                <img id="map-legend" class="overlay-image1" width="100%" src="../../resources/imgs/modello_stanza_solo_scritte.png"/>
                <img id="map-coordinates" class="overlay-image2" width="100%" src="../../resources/imgs/modello_stanza_solo_coordinate.png"/>    
            </div>
            <input type="checkbox" onclick="showOverlay(this, 'map-legend');" checked>Show the legend</input><br/>
            <input type="checkbox" onclick="showOverlay(this, 'map-coordinates');" checked>Show the coordinate system</input>
            <br/>
            <h3 id="Relevant-Positions">Relevant Positions</h3>
            The matrix number of rows and columns depend on RD (which is the size of the DDR robot),
            therefore for the moment we assume to have an M x N matrix, i.e. with respectively M rows (x axis)
            and N columns (y axis).<br/>
            <div class="remark">
                The relevant positions are:
                <ul>
                    <li>[0,0] = <ks>HOME</ks></li>
                    <li>from [0,M] to [4,M] = <ks>INDOOR</ks></li>
                    <li>from [N,0] to [N,4] = <ks>GLASSBOX</ks></li>
                    <li>from [N,M-4] to [N,M] = <ks>PLASTICBOX</ks></li>
                </ul>
            </div>-->

            <h2 id="Requirements-Formalization">Requirements Formalization</h2>
            <h3 id="Entities">Entities</h3>
            <table class="dictionary">
                <tr>
                    <th>Entity</th>
                    <th>Activity</th>
                    <th>Type</th>
                    <th>Description/Behaviour</th>
                </tr>
                <tr>
                    <td>wasteTruck</td>
                    <td>Reactive</td>
                    <td><highlight1>(Test) Actor</highlight1></td>
                    <td>
                        Entity that approaches the INDOOR of the service area to dump some wasteLoad.
                        It's represented as an actor for testing/simulation purposes: it sends dummy 
                        requests once in a while.
                    </td>
                </tr>
                <tr>
                    <td>wasteService</td>
                    <td>Proactive&nbsp& Reactive</td>
                    <td>Actor</td>
                    <td>
                        Handles the wasteTruck requests and manages the transport trolley actions.
                        It also sends updates to the wasteServiceStatusGUI and to the alarmDevice.
                    </td>
                </tr>
                <tr>
                    <td><emn>basicRobot</emn></td>
                    <td>Reactive</td>
                    <td>Actor</td>
                    <td>Entity that receives commands from the transportTrolley and drives the DDR robot.</td>
                </tr>
                <tr>
                    <td>transportTrolley</td>
                    <td>Proactive&nbsp& Reactive</td>
                    <td>Actor</td>
                    <td>
                        Main entity of the wasteService system, which moves within the service area and
                        performs the deposit actions.
                    </td>
                </tr>
                <tr>
                    <td>wasteService-<br/>StatusGUI</td>
                    <td>Reactive</td>
                    <td><highlight1>Actor</highlight1></td>
                    <td>
                        Entity that receives data from the wasteService and updates a GUI,
                        used to monitor the status of the service area.
                        We model it as an actor beacuse it processes messages one by one and
                        updates the GUI accordingly.
                    </td>
                </tr>
                <tr>
                    <td>alarmDevice</td>
                    <td>Proactive</td>
                    <td><highlight1>Actor</highlight1></td>
                    <td>
                        Entity, which is part of a smart device, that sends a message to the
                        wasteService when it detects the presence of an obstacle.
                        We formalize the alarmDevice as an actor because it has its own autonomous
                        flow of control, and sends messages to wasteService.
                    </td>
                </tr>
                <tr>
                    <td>warningDevice</td>
                    <td>Reactive</td>
                    <td><highlight1>Actor</highlight1></td>
                    <td>
                        Entity, which is part of a smart device, used to monitor the state of the trolley,
                        We model it as an actor beacuse it processes messages one by one and
                        updates the Led state accordingly.
                    </td>
                </tr>
            </table>

            <h3 id="Data">Data</h3>
            We had chosen <ksi>Kotlin</ksi> because it provides the built-in syntax necessary
            to declare our model elements and can be included in QAK code.<br/>
            <table class="dictionary">
                <tr>
                    <th>Data</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>truckLoad</td>
                    <td>Floating point variable</td>
                    <td>
                        Indicates the <b>weight</b> of the waste that the truck wants <b>to dump</b>.
                        Since the weight is expressed in kg, we have to use decimal too.
                        <pre>
                            var truckLoad : Float
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>wasteLoad</td>
                    <td>Floating point variable</td>
                    <td>
                        Indicates the <b>weight</b> of waste that the transport trolley is going <b>to deposit</b>.
                        <pre>
                            var wasteLoad : Float
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>WasteType</td>
                    <td>Enumerative</td>
                    <td>
                        Indicates the <b>type of waste</b> to deposit.
                        <pre>
                            enum class WasteType { PLASTIC, GLASS }
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>PICKUP_TIME</td>
                    <td>Integer constant</td>
                    <td>
                        <b>Time</b> in seconds, known in advance, it takes the transport trolley to <b>pick up</b> the waste.
                        <pre>
                            const val PICKUP_TIME : Int
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>MAXPB</td>
                    <td>Floating point constant</td>
                    <td>
                        Maximum waste <b>capacity</b> that the <b>PlasticBox</b> can store.
                        <pre>
                            const val MAXPB : Float
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>MAXGB</td>
                    <td>Floating point constant</td>
                    <td>
                        Maximum waste <b>capacity</b> that the <b>GlassBox</b> can store.
                        <pre>
                            const val MAXGB : Float
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>RD</td>
                    <td>Integer constant</td>
                    <td>
                        <b>Length</b> of the <b>transport trolley</b>.
                        <pre>
                            const val RD : Int
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td>DLIMT</td>
                    <td>Floating point constant</td>
                    <td>
                        <b>Limit distance</b> beyond which the alarm is activated.
                        <pre>
                            const val DLIMT : Float
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>Box</emn></td>
                    <td>Enumerative</td>
                    <td>
                        <b>Unique area, within serviceArea</b>, of RD width. A Box represents a position where the transport trolley could be at a certain time.
                        <pre>
                            enum class Box { EMPTY, HOME, TRANSPORT_TROLLEY, INDOOR, PLASTICBOX, GLASSBOX }
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>serviceArea</emn></td>
                    <td>2 dimensional
                        matrix of Box-es</td>
                    <td>
                        <b>Area within which the transport trolley can move</b>, made by N x M Boxes.
                        <pre>
                            var serviceArea = Array(N) { IntArray(M) }
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>ROWS</emn></td>
                    <td>Integer constant</td>
                    <td>
                        Number of <b>rows of the service area</b> matrix.
                        <pre>
                            const val ROWS : Int
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>COLUMNS</emn></td>
                    <td>Integer constant</td>
                    <td>
                        Number of <b>columns of the service area</b> matrix.
                        <pre>
                            const val COLUMNS : Int
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>TrolleyState</emn></td>
                    <td>Enumerative</td>
                    <td>
                        All the <b>possible states</b> of the transport trolley.
                        <pre>
                            enum class TTState { IDLE, MOVING, PICKINGUP, STORING, STOPPED }
                        </pre>
                    </td>
                </tr>
                <tr>
                    <td><emn>LedState</emn></td>
                    <td>Enumerative</td>
                    <td>
                        All the <b>possible states</b> of the Led.
                        <pre>
                            enum class LedState { OFF, ON, BLINKING }
                        </pre>
                    </td>
                </tr>
            </table>

            <h3 id="Messages">Messages</h3>
            <highlight2>Riguardare</highlight2>
            <table class="dictionary">
                <tr>
                    <th>Message</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>storeLoad</td>
                    <td>Request</td>
                    <td>
                        Message sent from the truck driver to the WasteService through a smart device,
                        to ask if it can dump TruckLoad kg of waste.
                    </td>
                </tr>
                <tr>
                    <td>loadAccepted</td>
                    <td>Response</td>
                    <td>
                        Message received from the WasteService,
                        that means there is enough space for the waste to be deposited.
                        Once this message is received, the truck waits T seconds (prefixed pickup time),
                        then it leaves and frees the INDOOR.
                    </td>
                </tr>
                <tr>
                    <td>loadRejected</td>
                    <td>Response</td>
                    <td>
                        Message received from the WasteService,
                        that means there is NOT enough space for the waste to be deposited.
                        When the truck receives this messages, it leaves and freed the INDOOR immediately.
                    </td>
                </tr>
                <tr>
                    <td>stop</td>
                    <td>Dispatch</td>
                    <td>
                        Alarm message, sent from the RaspberryPi to the WasteService, to stop the transport trolley activity.
                    </td>
                </tr>
                <tr>
                    <td>resume</td>
                    <td>Dispatch</td>
                    <td>
                        Message, sent from the RaspberryPi to the WasteService, to resume the transport trolley activity.
                    </td>
                </tr>
                <!--<tr>
                    <td>start</td>
                    <td>Dispatch</td>
                    <td>
                        Message the user of WasteService can send to the system, to initialize it.
                    </td>
                </tr>-->
                <tr>
                    <td><emn>serviceArea-<br/>State</emn></td>
                    <td>Dispatch</td>
                    <td>
                        Message, sent from the WasteService to the WasteServiceStatusGUI, which contains the transport trolley current state.
                    </td>
                </tr>
                <tr>
                    <td><emn>ledState</emn></td>
                    <td>Dispatch</td>
                    <td>
                        Message, sent from the WasteService to the WasteServiceStatusGUI, which contains the state the Led will have to enter.
                    </td>
                </tr>
            </table>
            
            <h2 id="Models">Models</h2>
            
            <h3 id="System-QAK-Model">System QAK Model</h3>
            File: <a href="../models/demo_system_overview_v1.txt">demo_system_overview.qak</a>

            <pre style="white-space: pre-wrap;">
System demo_system_overview
[...]
            </pre>

            <h2 id="Logical-Architecture">Logical Architecture</h2>
            Drawing with legend (NB: il QAK fornisce un diagramma da inserire qui)

            <h2>Diagrams</h2>
            UML (forse meglio metterli negli sprint successivi)

            <h2 id="Test-Plans">Test Plans</h2>
            Executable Models

        </div>

    </body>

</html>